{% extends "layout.html" %}
{% block title %}Attendance | Manual Entry{% endblock %}

{% block content %}
    <p class="mt-2">Use esta página para agregar su asistencia a la clase que figura a continuación.</p>
    <p>Una vez que envíe su asistencia y reciba una confirmación, podrá cerrar la aplicación.</p>
    <h3 id="classNameDisplay" class="mb-3 text-center"></h3>
    
    <form id="attendanceForm" method="POST" action="{{ url_for('routes.registrar') }}">
        <div class="input-group mb-3">
            <input type="text" class="form-control" id="studentName" name="studentName" placeholder="Nombre y Apellido"
                aria-label="Ingresa un Nombre y un Apellido" aria-describedby="button-addon2" >
                <button class="btn btn-success" type="submit" id="button-addon2">Enviar</button>
        </div>
                
        <input type="hidden" id="className"   name="className">
        <input type="hidden" id="date"        name="date">
        <input type="hidden" id="classCode"   name="classCode">
        <input type="hidden" id="sundayCode"  name="sundayCode">
        <input type="hidden" id="unitNumber"  name="unitNumber">

    </form>
    <script>       
        // Configuración para mostrar y establecer la clase
        const urlParams  = new URLSearchParams(window.location.search);
        const className  = urlParams.get('class_name');
        const classCode  = urlParams.get('class');
        const sundayCode = urlParams.get('code');
        const unitNumber = urlParams.get('unit');
    
        console.log("Parámetros de la URL:", { className, classCode, sundayCode, unitNumber });  // Salida de depuración
    
        // Asigna valores a los campos ocultos
        if (className) {
            document.getElementById('classNameDisplay').textContent = `Clase: ${decodeURIComponent(className)}`;
            document.getElementById('className').value              = decodeURIComponent(className);
            document.getElementById('sundayCode').value             = sundayCode;
            document.getElementById('unitNumber').value             = unitNumber;
            document.getElementById('classCode').value              = classCode;
        } else {
            document.getElementById('classNameDisplay').textContent = 'Clase no especificada';
        }
    
        // Establece la fecha actual
        document.getElementById('date').value = new Date().toISOString().split('T')[0];
 </script>
    
{% endblock %}